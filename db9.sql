-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public.account
(
    account_id serial NOT NULL,
    balance integer NOT NULL,
    bank_id integer NOT NULL,
    user_id integer,
    CONSTRAINT account_id PRIMARY KEY (account_id)
);

CREATE TABLE IF NOT EXISTS public.bank
(
    bank_id serial NOT NULL,
    name text COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT bank_pkey PRIMARY KEY (bank_id)
);

CREATE TABLE IF NOT EXISTS public.transactions
(
    transaction_id serial NOT NULL,
    amount integer NOT NULL,
    timestemp timestamp without time zone NOT NULL,
    currency text NOT NULL,
    CONSTRAINT transaction_pkey PRIMARY KEY (transaction_id)
);

CREATE TABLE IF NOT EXISTS public.users
(
    user_id serial NOT NULL,
    login text COLLATE pg_catalog."default" NOT NULL,
    password text COLLATE pg_catalog."default" NOT NULL,
    CONSTRAINT users_pkey PRIMARY KEY (user_id)
);

CREATE TABLE IF NOT EXISTS public.transactions_account
(
    transactions_transaction_id serial NOT NULL,
    account_account_id serial NOT NULL
);

ALTER TABLE IF EXISTS public.account
    ADD FOREIGN KEY (bank_id)
    REFERENCES public.bank (bank_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.account
    ADD FOREIGN KEY (user_id)
    REFERENCES public.users (user_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.transactions_account
    ADD FOREIGN KEY (transactions_transaction_id)
    REFERENCES public.transactions (transaction_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.transactions_account
    ADD FOREIGN KEY (account_account_id)
    REFERENCES public.account (account_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;
insert into bank(bank_id,name)
VALUES
    (1,'SwissSomewhat'),
    (2,'RiphysenBank'),
    (3,'ShkiperBank'),
	(4,'Dovgan'),
	(5,'Tinkoff');
insert into users(login,password)
VALUES
    ('Andrei','Andrei'),
    ('Sashka','Sashka'),
    ('Nik','Nik'),
	('Tim','Tim'),
	('Rob','Rob'),
	('And','And'),
    ('Sas','Sas'),
    ('Nike','Nike'),
	('Tima','Tima'),
	('Roby','Roby'),
	 ('Alessa','Alessa'),
    ('Sah','Sah'),
    ('Niko','Niko'),
	('Tims','Tims'),
	('Robot','Robot'),
	('Ander','Ander'),
    ('Sass','Sass'),
    ('Nikel','Nikel'),
	('Timas','Timas'),
	('Robyf','Robyf');

insert into account(account_id,balance,bank_id,user_id)
VALUES
    (1,0,1,1),
    (2,0,2,1),
    (3,0,1,2),
	(4,0,2,2),
	(5,0,1,3),
	(6,0,2,3),
	(7,0,2,4),
	(8,0,4,4),
	(9,0,4,5),
	(10,0,4,6),
	(11,0,5,7),
	(12,0,5,8),
	(13,0,5,9),
	(14,0,1,10),
	(15,0,1,11),
        (16,0,1,12),
        (17,0,1,13),
	(18,0,1,14),
	(19,0,1,15),
	(20,0,1,16),
	(21,0,1,17),
	(22,0,1,18),
	(23,0,1,19),
	(24,0,1,20),
	(25,0,3,1),
	(26,0,3,2),
	(27,0,3,3),
	(28,0,3,4),
	(29,0,3,5),
        (30,0,3,6),
        (31,0,3,7),
	(32,0,3,8),
	(33,0,3,9),
	(34,0,3,10),
	(35,0,3,11),
	(36,0,3,12),
	(37,0,3,13),
	(38,0,3,14),
	(39,0,3,15),
	(40,0,3,16);


